language: go
go:
- 1.11
before_script:
- sudo apt-get install -qq sshpass
script: 
after_success:
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST rm ~/server/chat
- sshpass -p $SSH_PASS scp -rp -o stricthostkeychecking=no * $SSH_USER@$SSH_HOST:~/server/chat
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST docker
  build -t chat-server ~/server/chat
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST docker
  stop chat
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST docker
  run -e "DB_HOST=postgres" -e "DB_USER=$DB_USER" -e "JWT_TOKEN=$JWT_TOKEN" -e "DB_PASS=$DB_PASS"
  -e "DB_DB=$DB_DB" -e "GRPC_URL=82.202.226.226" --link postgres:postgres --publish 3030:8080 --name chat --rm
  chat-server
env:
  global:
  - secure: V2OGNDO/v2n3DeaKuWnVnn2lkstaR8/Gt27dake3asJjqFTfaR38ppIVbbY68/rho9PBhRrHchtt7Z2IOAJmpM51AnM45dps7Pjg4y5fx7RNTSIHRWSaPzjo0EA2MwWhKhGiwlyQm8wonZEjTfqOpymlKbacff8XTc/8LaRITTBZmYt+wABtwa1yrJRLKShPbwcme/i5Su1S3bnNX2mkC3X2lA5DxHQ61ABcWQoPhJTxuPn74sd11lSbIDnWTpGVDASW/NxBfyRKtQ7+6b9on48NtFeUJONnO5IiBEj+yro7xabttclRCFxW7+yYCu2ixoWg9y1Qzz+gugOP+Sh9ZJTcgFmWefPP6m5z4mwwXlUmoSFVIWFuNk3pZE1uJKYZ7keC/QWEf2lfi1Lj7m9hll0O6dzeAQqSWsre6WvC57kB2ehMAusM1+DhCJlm57gFNGcJtKNGdrZOYMzEVVzBBBffGiogeg0wnyNb3tPsbFpdIBSZyUJq/dYiTWyyEAY2u9IAmIkdMgmgb0Cpjl0TxQ9ltJzPCjPQwXlzgQUvvfNo/ICmhiodnNyvKXI1/TaO8zPbCKNQBf/XL8wpSq0YZ/2Nujtcr1+A/fPLUFMhE7pSJ2ixNYRa0KrXU9qJbEklUEo+XsWV08AI5kEGqr66ltM8Cw3q5M2j3GIQBRZZ6ng=
  - secure: DwT2pKUpgEefojznNobqzj3XwMmAlcdPC0iQOrHzMcp71IpfbBGgRZqQykSfoCH+MrEj2Pd542POS9KNPqkIBm2MwdipvZy4KZS7tNS16D7mkRtzPdSQlwFxWBEA2jifW3AD145Ztt0UGdnABGbG5K2F2hBOeBA9BQmKLp3912PeEcx4XAiVzOsR4YTYCky4A/IhHr29YgDWZSaKaEzGoVUk9KZxBCbCmn8DS3BlRZpOQKVaRTnszaxz8hJXQ2jtiKiCRSawuAacQfc2hyPukA643W2pMUgS/xtkK7oiw73Ysi94VCkElfqAqX2Yb6AYVegKpHklVqbI3Cyj93w/NyjVG3anY61egELq6vWSwmwACaJUkSAHyebtGC/mJZ8Z30adkSh5IB+hE13HONvfZWHNJm2aKFO8Z2cIxKtbQZYAjHBJ1D+2KEMjUsNzhFKwfsv8GlCZCTZcmVwmYXFnjt5No+ONuBUidg80VoV2u6u9rMdjGrfQhEqcLZPtykbTMivgZTQlODVS4pB3uJ9I/VjRryKwhrm93wOYDCxHUIdgFBv2sjc2efpyrXhyJfGTAHWQJHCLvO/6SaPQRXdrGcPI0jE61GbCM1puG/DV+NUTAl2YXdcCL3I2Tg63itUUFVk2KUl0ngH1kTM9Cgd/1f5kslSk+bxiAi+qNfaiD7c=
  - secure: mZwQveJ2DolbNr6O/lRWbrdlajp60QywroZSezkipUOOhTH7scFLseYMSbNJ9712wkArNqy1KCAS/gbpnMp6BLXXqPD+/SNRc6B8TkornllwGSgPo0JqYc6X5/APqjNeeU0R0MdryTtY39wcbbbZy5iHY6S3kdoihuJU5+HoMT3h9HbnyAR94to5AaFeHY4QgCNkfirPOrTube1qZa7FL19GbnW5lKY5izJlgzdm7T6jUL9MA898v+2G378z7UooiL0N5o/Bf5VOlhBmU7aXgLfl1R96yZw7+BbKCf+UNh3wvgtNeacdBUSz0YytRcdztYoL6wNRXW2S3Gf0tWXVvNK1f78X8qf9EhZdMuB4Wv/9utWKfDk3T/khniahRMuS0vcuKprFSc57eAibylO+/LNZlLCFYfd8h0TrrOV4ehM2KcgO6Jl7+8udv6cAwczWBdZpaEb0XJqBaz1194+HtFhj1S2zJkmMYNaEztlypMJUM8E8KAP4fDNoy5TzzysoBeEyvJX+8mt6tFymLW8xpWMVauJ0lGzcO6G+W+zyj82FSFjeRji4AIrAVIKgpG8qHJLw0vZQXo+0wSXuZMbqqToaf2Fb60ajhkaG93KjN2Ks41pLmHBG9qnIJiw5ipMMFxo5dI40+prJkE/Bt3u1EYSPE6x+sUscSxBQ47e+j+U=
  - secure: WwJ17dJbTwLgALFcsn4CghGYiXSeU0BWZJAHA0ut5mmqqNgOR8spPBMpxjuhxJVgdkt7MEXqGejAuxR+TWVndcTUfilH8HwMYCW5GACGgRNNYCocDnU6gVV37x6f+56OvQmHDzbMta1oPupJ7ih7ta22L07WdS54QrtgDgXUNLIfrOpeLhPRmYy2ihRJKsV0IzcN9dewBRgskrPJ12k88K1HT9PG5Ot3LqS1ha/FEU0BhTODnGrK96qq/BPnLvnpfYubdKiWOa/UYn+tS/e/xQrPh52lQd5gxDBhtWkXRClSFOdjr5Dj6xtH/8nNBrqdhGAA4Bm+C7tPS1RoFVeR8cOwfmZfKFxGxcNcv9EXGkPETxN18IaWK5sXXuB6ScayiOXPjeggEsp2X6YQq/ATLON/rurSD7CNc35dEOn7SOJ7vETzSgKI72adg7r87NltCMTANM4e9Rz2EUaYO19jhWYt3JYFIraQ/4iUgfCoK5LNCp8ZV80kPdsAcy6ks16SPbjXEzJMOm9x2r7kqAjmW6gIzgnM1Qg796VwCmABihaQmDsvnsvT+j0JWSy2qAS8H1sdCiJsSXVTpIa3Ee5x6cXcmW8l/DmYu+xMowoFqCkGHkelLXJXa840/LyYBolD2X2XVdAhqQRd9lZuw48qJZQU7LrNVva5uly2P6j3Slk=
  - secure: EQdxqJozj48XGM09QZxMSCgLGb+xiIPFyHVNQ+RL3Nqr9aBKc3OTpkMa8qr7Qw8yez58AsM70EdoZyMFMpCJDuzzK6Aycp35vRjrSANjSUCiKJqeZm5guCMvtzxzSl8EiR+iq8pEcy0foOYLfSmO++BHaU+gxfY6XmiirUG6dmSmj6JN4OBymMTVHPzxWwJmDeV4CB4mulatereLfozJHqKb1jYYenNbvnpoG7V6f1OF70wyBbGsv3ud1woW8JvRHkj04a4vE1SMuaE0+p9TE33lOSa/eB4DCEklHc8FdXGSPlKI3MZ1RKXV1ZiLaKt33RUAdgUU5Lnpi58pNX27LWtyJYzrPp/+SHMk8zRJXPeuHC34wbaBDtpfWy/uIckxxWu9WhhZ/7OsQoPbTl7B1qbc70Cdyr7YwLDbcDCePlz3KG7LZ3QlVfTxGIzo/i22gwH2l92bJSiS+JGbKzvMxEelZzTcrPc2dSWSheaS/VTwRxpHikwKFhiGNk4+LBIQGKstog8VfAlkKxtdg+o/RYChJuTjDOaYetYms+9hCpMNsE6bc8aFDxsJNiIlki++PUViiBUZTs7Ce23Q343Lz506Y2a8+T6UIf+zQrCZRVFiiOPhI66CHqyscdjWcychEEeSSkPpamYwY8sl25reJ92tHPhwGTQl7VYJvSNhFLU=
  - secure: H0aQw67MHvgx+d7g68Fc4lSHaTDbIYepjdaTNiZIm7/OQBy5BL5NpEUuNkcX4mIeDrRraK+0z9GCQLsWbWP1sSmMx1T+4aJDdNy9Rdq4XBQOfdcJGvMIHpqf4s5ALUxwdMZQAYsyrD3Y3/hPzmq+yX8zc0BzrNlNB0YOlxta4keusykfbaKrSpdBalNfFe5k/AjYiDVYjrbPILWEx8U3wGs0dALJXEt7hZ08Mc58CAfxN2f5awMFwjM+95Wqkxc5pf4sZfz0S43MU/BcO3jBwW6+OYdMuqO2ZtOhBZbp3Biwld4/Vl5dvLbX/MaW2teGbpw7DAcwCpFUDnjOxmNRfJGXibvSpCThxIE6A4V8R6N1GoG3gXWv4BKNXYG3dQKH28bHd2dxHGKXZGg01sQTTiaxjxxsgcWZkE10ldw0ZrkF7N7cXxgIqVoi7uxutPaKCdd3t2RL49RX/sj5xTyMgTJ6Jucdfa0+FoejWQywmj6IyCTjILxHRA7QU9f8u7TpkEDgbOsJGf2XnCzOpp9a6c6ccB+OFTCqLx/ABATEvFI2EnvNPfABY68fGQQMJiK19PyUl8YZN5dwUBvPH3UmjXYNI7r2MZsMNhLre/manUVoyCWu/wwWAcwoZQgxjdCnaYAd3cD0ixwPAv5nGVqf9DhZB1kBA5lMJoFxR1eUXfU=
  - secure: CObVuhp5VrKvxw9O9Kw41HRJXzdYVkEteHJOckXB1X3P1n0Weq2DqScyEcBtpA1WR130Zbp3mPvWeAcF5e984mWjMym06cZFCh0I+M1HfzXT+fGYLwTypC+dpiI/9hz7RLTRpnCfz2N4Zp8Sjd4qdkp8vLuLfq4Y3bHp/BqKkJIQPXwX5LOVG9O5cCXpEZuqyHfEXrgcgq1pi8pUJJ/XHBSKV+Mtn9qy9/qabQC9Me6k9+KM3f1UpdGMJyqlA59p1Q/HuFWEigMtuLL0IvpHoGzILqo5VSGE6jVEka6M5I+WBLrsjZmWBXKKc/VjlXhiDD+3GKGvps6WGAFSIi2yTKHMYg67Vn9mT/oA0iQAAlgiBaDLdSpJeMDiljiwO2mfPD5YTuhP9Ny1Vt4atnvbuYZJi9J+bYtx7XNjgRD5PkNgcv29g7QleNmsgSDLwhpsP+K4RscoQo4wGkep6WeMllhuOVvyrq2geVwUfeBoRoyeHw65yE1b44VOyOPQdFdnhUCjM2ipSEw9Sgd4LKSrTwHFH1Ga/KNEYFyI1P/XTYdEgvnwTy0srRGxbCUKJZnL9wo7E3r2ED7zZyV/9VQSqD7ycOXFgJBrJCgQ90blWr/UCGvto9rcf6sWYRK4fu30N3RjYAKNnd3C9z9Jl63tTZtB5Nvp4WZ9QERj4tFERY8=
