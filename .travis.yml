language: go
go:
- 1.11
before_script:
- sudo apt-get install -qq sshpass
script: 
after_success:
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST rm ~/server/chat
- sshpass -p $SSH_PASS scp -rp -o stricthostkeychecking=no * $SSH_USER@$SSH_HOST:~/server/chat
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST docker
  build -t chat-server ~/server/chat
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST docker
  stop chat
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST docker
  run -e "DB_HOST=postgres" -e "DB_USER=$DB_USER" -e "JWT_TOKEN=$JWT_TOKEN" -e "DB_PASS=$DB_PASS"
  -e "DB_DB=$DB_DB" --link postgres:postgres --publish 3030:8080 --name chat --rm
  chat-server
env:
  global:
  - secure: g+/36SqTnYuINqk6cQra3UtCfK2Syy0iaZ77nTMhCpZ7xyJPx3UiPRiF0aDHho2ryucwzW8EOUq9AInY496hIHMN4eVjBw3Ed14aKulQztnAEtnYH+FIPB6uT70eO58hoqzioyfKS3MLv9v3mRuUEp2L+j6hAAnP24/bpwI4KdcD3h6Ost4ZhKNm8Tkr6GFqQbQiyFqkzTnTD+jWKU+xR1qeCbUArbWJBq5RCObSzr+jLHvLQ69NcIJgZ47uE/N+FXB+oZw7pM7Wk2wjYMR59ONY47VSixOSepyBZgJXGftaOmFgWq28/+UmdBe6v32R2x7rzNQBlISFqOP78yi4WoBlf2CCWJtaBWmRoXRdMCkBLTtRJq4IFZrr+3JppAJU1Ux8BI7AtKS+p3L0zFwyp3CPzpEcqd1Kr6OPSYj6/dqTcbYqwSptoYGDRHfsyCwDfBlFAYdMayDb87OyXbC3m5S6BTpXbSTzj/S+D7BTPI6z7UWxMZq9aCziCPtufmEBEm8pbEYQEhyWzgg5cXgbqe7Lmvi9yWDCl0Pf4jc68Bvnm83SsA1ivzdDUT1EtmQxeOOgv5I+92EpLrLYUNJM32MVMf5H7SMdYxxqOM9Xg+1dkSpplp4FsWzNB20QtdvpbM376rgscI7qZnO8QO+BSi5wi8ILH11x2WAaWbrYE8o=
  - secure: iAF4HWuSLKryUjoA4d0tST+uZF2Cz6qmNFxN2W9kg1KL44WwzmBAmq7i4ZbKOSilq4A0GcB47L6Db1AafQepaaAUGkV8al09MP3Ww6awmcaDPzNaREbHr8NBb02FImbl1LToPVgn503iu9fAodFuR1WUvrzXObes7Ewl3WtpUaMbvjJLo3Jjyl4cYoGuEAkfn1xhOvkwdNZEFFw7MnOocgANo5IUAuy8+2AuhxSn899fwjmvBgorcu85HrGX80/U0Q7yDRebS33kURmAm2F1Yq+/i9HCt8L7pGbZgepJZgym6Pi+ksgrYbN9dggbRIjE4HbMu+m3+NTWdxRBzzeToWzTelVCi9RGPWf3utiDuPdMav7sEdSzdLQ8LQzzGtO171FR2+1+DTROMLQjKkFKAUWXLMtKQPvPzn4O1vJ+MAXyWc2SINW9VhzJBk7qtyG30ZbrHJEsbE3FpGWN+fzKjZtm2O80mfHwDwCoqP8nqZzb5OLVA0CpY7V93Xguqa9yayyjtCo3TdBa+gs/JVNxB8TAYUl4svySadOP7GTpeBf8CsauHFYJk7MinlRenCi8n0VcRQddxLP7/8yy0OknW9FgHfIP6PSHbEAtIah7cdi2zqzhbgYCeMp0nxtI4zkl2Q6GXRXwDy/xo0zDzX2JEK8UvijYmiZMOyAuEEpRpnQ=
  - secure: k7/fDuM3GZ8t3Q2gFWMOZVCQBHbFcRETVU4Mg+JlrLgQSU7khO39d7lwR3V5k2Ks/kbDDXsgC4baO8ckxc3SXzMcGUs5Cig2ok2F+/qSSIpJrzI/vf4LRvJDgRQuNdTZ+PLeuwc2Xv5VKNz/99GkCFM3dHLHEvyAWywFxHWtL2OQCp2GBUOETnGdEtgFMbz/wyeAQ9e+bCRj3iV++ChcSyz4J/7lgIDVMz4LguLjtRqg+AQbwKRZFdui0aEydWYHdmUX6UFa/2KyxeuG4J9MkKeAm4jkqBnuWALrrSjxriEE+lXskBaHOWxgVbiKWNhYgvYS97cmxpfFvsc04pnFr9T3hOk9c1SxXGYFU3Rz503wH6YAYPVezKOObCMAirED6zN6rpCefuFHf8AzLlN6AyWOItjUe+0z2Nd8xKwTZ0CIll9vAjuTLvvxJ7+Bwrd95YxKa24WoTE3ak38iHl+lp6xBmz7Xq+mE7VzTn6RTCUDpL6WXgIslASNDkKjBHIe0+7p5vYLLh/DhG5ENFPOxJ4pBwOzLJD3OQHHjIfWTY+1airBVB1GHiWtMMa09w6LGDHD4PIpDRtgabnwpe1Kz/MgV5qsoI3jKrXRPIhVdpwZk3cHRt8d6e3qfUS4Uxb6Q0JRAPXx9gyqvzgFlcDDP5NfpIdYlXkuTmtr6DKUoAo=
  - secure: lyBHRhrUUFtwmeHeLjZlMipSGEZjleOGi2UJ8lsmRXFLugDxZyvSFM+y3WpPQhHw8aCFt7ViEwo8Xqgk6hwuG8TtvtuxWZXzm5mP2rEKmyWBd0HQGf943Ei4+KcivgBaevSL+y9ORVv8ENBkPnhyLvmsfLWK+CA4yLQabtI7fx+l1w0fPu6dswjjeOnZD2A0o/ARrsglbsJ3O5hHRLMtzTzFJMWxMs9C+Z7jjU/H1PT1cMN2IDx8/VwS1+xnA+AqSFnklnyFmZAeN7Sc6BA0ryG4sNyULDpQzFYMM3yWv5cJLJGjcwIgaKvI8vEQjZVLhfdTu8Z/kTdKw4Iljk2DVk7RgUb0wPeLAJkFaphvWWt3LWRKu5tlhm5NCELx+k7ZEPOVmt8frEWbQKan8rNRyqzEomnRHNCPdQTurbrxBkHhtbYbc+LcZiMVJbOeQ9bJ5X728tUuhbB/ctc8ptot5ee6nP1mJujGRAlQ9hvvBGk8HA+NqcHJ+Z8BQBuc6zkWynxzwUjo8zhFVtOoejbmi3eHi5r18iuNvGNenF+rawTwOetMO4NnA2yz9PB84sy+VMZXLT7mFC5c9pHaxmPDH+vKOz/g5DLO7BrxhZBBOqhcg/V/86SqOD6q24QOiFxeAn8Iaih+YEoQcZkWnBahGjK7SlLZQj5OSgpVUKI5tBw=
  - secure: NrIc1u4Uydvqe9ogZ8mTWbXQyrYF+QOdvu+hIm0Ma3DsKVM/Nt0cIi1T1S9Pl5FRwt+iYbvi7qaia1eTQhzYpBoDyE+6+j9euSSDSZOohL9FUEPYPtznuP81/yPNEcUf3NPqSMS0jxmDF/4LqATCQP6YE/vq3/IR/D2VdU87qNFXwaN4EOnOuAfmW7h2nRPUxtjbahq99tHEDgy/EWvv/q71vHKQNHYCKzemZtqsRbZYRxYffyFJTbe9NhZbBvY9LYNNX5qbb/rZLjAG9kz5b22Fj341RDgsRp1jnsNaw0VRa94kV6USkOwdQTl7t1ZUGDJXkNyWtmEWFB7K1mrtPF9PXdztB1+drdClOjgsiJXdC++pZQeQVGLfXryMxWbm9Yvrhifv49uI9iT5ODi1NjLXsD+63biQNVssDGhnYqJ9ZVA1gsqwxrl1LkAzM1RvN9J+UofXxCY6XsHD4K5KIJue6cL5a8u0yGz22uzpGyrbTgprcur2CXnYo4zN25PCe4YADWeNOG8h4s3QHwTWES6+ZyhcKKh5FnvRzXKCTaimNr1FE+Gkp2/jsmTgiPCh49EvQVl2S19HTo4ikzByK2Tk+z5K6RFPx+w4ozmFY+0LOQDI3vsyzrQnYRAbln8iymYrW+IEYxuj8zhok9wI+4gjD8v+2yc805z1CuRDTBw=
  - secure: aim6NzE2CTpWfio+23bEKpPwynjz0tFuL/SReevvSbKIMG4U/XA9pl0rnCUJd8Aq3B/SVPfiF+ysH9+gAmszXkIfCqyzZ6kap9HOcGCPnr7KsXRveSdLoaLHp4lKd8RyLx/fB/zj/ONZhFFSq9NWLfjmRCwrVXaHkTJGtdyec+w6J44h25YXlf+JBAGNpy4lSYTK5mxCvAI2neI9aF2g3AMLfqrLMmqxACOh3ukOitrVenz++D1fuy0NxRbp8tKeHD4oexEu+1VBHChGEMuzD9D55Qcf0lkBgVfkTJYxOR5N461XFjJpido5/feq+pPIgC98GoE30v4F9vKtY4W8SOcH2/HB6kIx98q8dty6bIVFxQliRO/6hDzUghNsfNXgbjwz5uHbcPNStiMV9qx7GBhC7bqaUCHDHk+FwgVitoVRQLuUO2Ry2wvknRRYEDH7l9IdOzkA2uSyoC9/cEkgKZkIJqX/jPkWqKm7jQQ4zKF1vOeTAJj3/t6nlUd+wsjDCCAHWOuqOprCQ1DY0QC7lILGWg3pyf3YyvDT3yUIw0D5+6ElwbnBxlZ/VRtzqHyAkS/r2FAdcL1G8b7br5AWPnzsHpN0NkPmq1HJeMtcQSRe0T5yryWOipdkm4kFGXT0XDf4uCKooNlu0uOVUhUdDvdEaWdT6XX2VcaGLx61yXQ=
  - secure: WnYvyWNFmciUzM6uEhdFtExgHRX1YLMK/7uEaA1oq8Xs6dmk6koezzzDUKBvb30d20sN1GD218aipy9Agsfw1PvOyogIgm3NC7+EcnyukhWhRx40zWC6t0VqezRxI9KIPZDg0C7e1oCzY+sXxGAi7VeMXuB1cUUX2VB9OibaUNUEBDYCX3Y68HQJvj801GUZkqKdUKF0JP+Gceb6z8ksonO2huo15Jw3B9C8k25nLi4bL/UIUGHwJC+OVPCBarZAnsk7G4GtJag7Kn7EwgAzOS5Oa8m7k6gSWjgDD+PmU3u+ikSv9pe3IUtpQjNReuOdNfhOvqiN/pi/zUtL8+hSpB8RQf1WtXVRUFdsp8i90m6zDAghJ2MPxXdSdUIq1ZPy4EfHkppkF1BHRXbbRUT8KA5jG/IgXYF7Lt77J3KdnuTbJIohNf79XH8uAat4TMoXr4pMvRN/ryQ5cQtTQByCYI8bCWeWfYRZMmYw8lAFiawuYZ9drBJ0Jw16GFzdt6CPBwoAlcaMmx0mvlPuhU+TEXsp+oQFxDqHnaK58OfFY59WTPBIEwxuB5GATRRpQ2oBLdUmPqk6oFAotPPPEEJafyArc+Ozk6xJH8Qd5CPTMRruKkeufoQliVW+pZ2FWkOGG9k5SmvE2VeafBW+LgFwTaPdiCtdShjZoKvPGTGbgjk=
  - secure: LOQL2ydHDfj2Zma06MHVkcD9ssgqxGIpW+cqitJ12VjG4QIHgPnrelGhhUtVzwXQoZAQ6Vcdlj8UVDsNFewzXuPlnZbnxD3WbHbBKU9il6EweWTWPz+oKzJe0KBVBMsHhZ0crzsq37RrNFOhLW3lgut1Sc16i2tuwpujDpUCaRKCSb6zr/V+8nUXQjsORIMQvz70o8DfJ2T+85PLzj4kcKeDQbg75oJT11YLJ467urNglUJn+CXbCytHnb5WCgKjxGcYC4RcY4lmMRF377ItOJCfEe20+U2WVa0p6pH1ORvtbEihy2kpogl14l4ASdaYHfAcM0sPYCk7X2fnvzOh5Sx9rFPU5uOuQL65heRvym974FzHXJRKpkOUX9FffjSNPFWerxqpGs1vJlFdCbwr40Fi0g17u5fLwxh+hxivLc6rhnQsTsm2truDZwl0Fn2mmQLOlQUyzq7t/rtuwM8B20pSS6fYCGnqFjch/yYLRSyH6GZpru/8232P4q/GQ1ZzY9d8pm3k7C2vynGhYfQBn0nbCQvVNec9+CJC/ij/k6N9yL/e0X+o/8cYtRmE6fb8WBIf6N3v79Jq5dsqxgN2Oaygr7mMi1kgRgnx5tpb5/5u7m1kgiUMihripNCMZ/puxPzJ3kEHOFIsIPbwBybXRYPV1q2lFn6SRkliEGxCtmg=
